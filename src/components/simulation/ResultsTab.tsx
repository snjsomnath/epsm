{/* Full updated code shown above */}